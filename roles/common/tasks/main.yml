---
# This role contains the common elements to all systems

# This task commented out for testing purposes (too slow)
# - name: Make sure APT is up to date
#   apt: update_cache=yes upgrade=yes

- name: Install NTP service
  apt: pkg=ntp state=latest

- name: Install harden-servers
  apt: pkg=harden-servers state=latest

# - name: Copy Tripwire preseed
#   template: src=tripwire.preseed.cfg.j2 dest=/tmp/tripwire.preseed.cfg

# - name: Load Tripwire preseed
#   command: debconf-set-selections /tmp/tripwire.preseed.cfg

- name: Copy Tripwire debconf database
  template: src=tripwire-debconf-config.dat.j2 dest=/tmp/tripwire-debconf-config.dat
  
- name: Install harden package
  environment:
    DEBCONF_DB_FALLBACK: "File{/tmp/tripwire-debconf-config.dat}"
  apt: pkg=harden state=latest
